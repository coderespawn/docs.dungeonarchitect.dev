<!DOCTYPE html SYSTEM "about:legacy-compat">
<html lang="en-US" data-preset="contrast" data-primary-color="#307FFF"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="UTF-8"><meta name="built-on" content="2024-05-28T14:06:25.7884849"><title>Setup Gameplay | Dungeon Architect for Unreal Engine</title><script type="application/json" id="virtual-toc-data">[{"id":"setup-game-map","level":0,"title":"Setup Game Map","anchor":"#setup-game-map"},{"id":"gamemode-blueprint","level":0,"title":"GameMode Blueprint","anchor":"#gamemode-blueprint"},{"id":"finalize-game-map","level":0,"title":"Finalize Game Map","anchor":"#finalize-game-map"},{"id":"support-locked-doors","level":0,"title":"Support Locked Doors","anchor":"#support-locked-doors"}]</script><script type="application/json" id="topic-shortcuts"></script><link href="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.css" rel="stylesheet"><meta name="msapplication-TileColor" content="#000000"><link rel="apple-touch-icon" sizes="180x180" href="https://jetbrains.com/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="https://jetbrains.com/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="https://jetbrains.com/favicon-16x16.png"><meta name="msapplication-TileImage" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-144x144.png"><meta name="msapplication-square70x70logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-70x70.png"><meta name="msapplication-square150x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-150x150.png"><meta name="msapplication-wide310x150logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x150.png"><meta name="msapplication-square310x310logo" content="https://resources.jetbrains.com/storage/ui/favicons/mstile-310x310.png"><meta name="image" content=""><!-- Open Graph --><meta property="og:title" content="Setup Gameplay | Dungeon Architect for Unreal Engine"><meta property="og:description" content=""><meta property="og:image" content=""><meta property="og:site_name" content="Dungeon Architect for Unreal Engine Help"><meta property="og:type" content="website"><meta property="og:locale" content="en_US"><meta property="og:url" content="writerside-documentation/unreal/2.32/sgf-setup-gameplay.html"><!-- End Open Graph --><!-- Twitter Card --><meta name="twitter:card" content="summary_large_image"><meta name="twitter:site" content=""><meta name="twitter:title" content="Setup Gameplay | Dungeon Architect for Unreal Engine"><meta name="twitter:description" content=""><meta name="twitter:creator" content=""><meta name="twitter:image:src" content=""><!-- End Twitter Card --><!-- Schema.org WebPage --><script type="application/ld+json">{
    "@context": "http://schema.org",
    "@type": "WebPage",
    "@id": "writerside-documentation/unreal/2.32/sgf-setup-gameplay.html#webpage",
    "url": "writerside-documentation/unreal/2.32/sgf-setup-gameplay.html",
    "name": "Setup Gameplay | Dungeon Architect for Unreal Engine",
    "description": "",
    "image": "",
    "inLanguage":"en-US"
}</script><!-- End Schema.org --><!-- Schema.org WebSite --><script type="application/ld+json">{
    "@type": "WebSite",
    "@id": "writerside-documentation/unreal/#website",
    "url": "writerside-documentation/unreal/",
    "name": "Dungeon Architect for Unreal Engine Help"
}</script><!-- End Schema.org --></head><body data-id="sgf-setup-gameplay" data-main-title="Setup Gameplay" data-article-props="{&quot;seeAlsoStyle&quot;:&quot;links&quot;}" data-template="article" data-breadcrumbs="sgf-introduction.md|Snap Grid Flow Builder"><div class="wrapper"><main class="panel _main"><header class="panel__header"><div class="container"><h3>Dungeon Architect for Unreal Engine 2.32 Help</h3><div class="panel-trigger"></div></div></header><section class="panel__content"><div class="container"><article class="article" data-shortcut-switcher="inactive"><h1 data-toc="sgf-setup-gameplay" id="sgf-setup-gameplay.md">Setup Gameplay</h1><p id="-83ayzb_320">We'll create a new map and set everything up, so we can play in our dungeon</p><section class="chapter"><h2 id="setup-game-map" data-toc="setup-game-map">Setup Game Map</h2><p id="-83ayzb_321">Open the map where we set up our dungeon in the <a href="sgf-build-dungeon.html" id="-83ayzb_322" data-tooltip="It's time to use everything we've created to build a dungeon">previous</a> section.</p><section class="chapter"><h3 id="enable-level-streaming" data-toc="enable-level-streaming">Enable Level Streaming</h3><figure id="-83ayzb_323"><img alt="J 206" src="dungeon-architect-docs/J-206.png" title="J 206" width="392" height="245"></figure><p id="-83ayzb_324">Select the <code class="code" id="-83ayzb_325">Dungeon</code> actor and set <code class="code" id="-83ayzb_326">Enable Level Streaming</code> to true. Update the following parameters:</p><ul class="list _bullet" id="-83ayzb_327"><li class="list__item" id="-83ayzb_328"><p>Set the <span class="emphasis" id="-83ayzb_329">Initial Load Location</span> to <code class="code" id="-83ayzb_330">Spawn Room Location</code>. This will make the spawn room be streamed in first.</p></li><li class="list__item" id="-83ayzb_331"><p>Set the <span class="emphasis" id="-83ayzb_332">Streaming Strategy</span> to &quot;Layout Depth&quot;. After the initial modules are loaded in, this parameter determines how the nearby modules will be loaded. With the <code class="code" id="-83ayzb_333">Layout Depth</code> parameter, it determines the room the player is in and streams in all the nearby connected rooms</p></li><li class="list__item" id="-83ayzb_334"><p>Set the <span class="emphasis" id="-83ayzb_335">Visibility Room Depth</span> to <code class="code" id="-83ayzb_336">1</code> or <code class="code" id="-83ayzb_337">2</code>. This specifies how many connected rooms do you want to stream in. A value of <code class="code" id="-83ayzb_338">1</code> would stream in all the connected rooms the player is in. A value of <code class="code" id="-83ayzb_339">2</code> and go another step further and stream in all the rooms connected to these rooms, and so on</p></li></ul><aside class="prompt" data-type="note" data-title="" id="-83ayzb_340"><p id="-83ayzb_341">For side scrollers, set the streaming strategy to <code class="code" id="-83ayzb_342">Distance</code>, this will stream in all the rooms visible on the camera, regardless of their connection depth to the room the player is in. Update the distance value depending on how far away your camera is</p></aside></section></section><section class="chapter"><h2 id="gamemode-blueprint" data-toc="gamemode-blueprint">GameMode Blueprint</h2><p id="-83ayzb_343">We'll add the game logic in a GameMode blueprint where we build a random dungeon, wait for the dungeon to stream in the spawn room, place the player in the spawn room and start the game</p><section class="chapter"><h3 id="create-blueprint" data-toc="create-blueprint">Create Blueprint</h3><figure id="-83ayzb_344"><img alt="J 207" src="dungeon-architect-docs/J-207.png" title="J 207" width="334" height="470"></figure><figure id="-83ayzb_345"><img alt="J 208" src="dungeon-architect-docs/J-208.png" title="J 208" width="542" height="738"></figure><aside class="prompt" data-type="warning" data-title="" id="-83ayzb_346"><p id="-83ayzb_347">Choose <code class="code" id="-83ayzb_348">GameMode</code> and not <code class="code" id="-83ayzb_349">GameModeBase</code></p></aside><p id="-83ayzb_350">Open the blueprint</p><figure id="-83ayzb_351"><img alt="J 209" src="dungeon-architect-docs/J-209.png" title="J 209" width="113" height="147"></figure></section><section class="chapter"><h3 id="setup-beginplay" data-toc="setup-beginplay">Setup BeginPlay</h3><p id="-83ayzb_352">Create the following two variables:</p><figure id="-83ayzb_353"><img alt="J 211" src="dungeon-architect-docs/J-211.png" title="J 211" width="251" height="51"></figure><p id="-83ayzb_354">Create a boolean variable named <code class="code" id="-83ayzb_355">DungeonReady</code> as follows:</p><figure id="-83ayzb_356"><img alt="J 212" src="dungeon-architect-docs/J-212.png" title="J 212" width="349" height="361"></figure><p id="-83ayzb_357">Create a Dungeon Actor variable named <code class="code" id="-83ayzb_358">Dungeon</code> as follows:</p><figure id="-83ayzb_359"><img alt="J 213" src="dungeon-architect-docs/J-213.png" title="J 213" width="331" height="289"></figure><p id="-83ayzb_360">Add this to the <code class="code" id="-83ayzb_361">BeginPlay</code> (right click the below image and click <code class="code" id="-83ayzb_362">Open Image in New Tab</code> for larger view)</p><figure id="-83ayzb_363"><img alt="J 210" src="dungeon-architect-docs/J-210.png" title="J 210" width="1801" height="1021"></figure><p id="-83ayzb_364">This blueprint does a few things:</p><ul class="list _bullet" id="-83ayzb_365"><li class="list__item" id="-83ayzb_366"><p id="-83ayzb_367">Find a reference to an existing dungeon actor in the scene and save it in the <code class="code" id="-83ayzb_368">Dungeon</code> variable</p><figure id="-83ayzb_369"><img alt="J 214" src="dungeon-architect-docs/J-214.png" title="J 214" width="497" height="147"></figure></li><li class="list__item" id="-83ayzb_370"><p id="-83ayzb_371">Hook to an event that fires when the initial chunks are fully streamed in</p><figure id="-83ayzb_372"><img alt="J 215" src="dungeon-architect-docs/J-215.png" title="J 215" width="739" height="355"></figure><p id="-83ayzb_373">We've previously configured the dungeon actor to load the spawn room as an initial chunk. So this will fire after the spawn room is fully loaded in and visible.</p><p id="-83ayzb_374">A good side effect of this is, the <code class="code" id="-83ayzb_375">PlayerStart</code> actor that was in the spawn room is also streamed in, and now we know where to spawn the player.</p><p id="-83ayzb_376">After the spawn room is fully loaded, we set the flag <code class="code" id="-83ayzb_377">DungeonReady</code> to true to start the game (more on the shortly)</p></li><li class="list__item" id="-83ayzb_378"><p id="-83ayzb_379">Randomize the dungeon before building it. This gives us a different dungeon every time we play</p><figure id="-83ayzb_380"><img alt="J 216" src="dungeon-architect-docs/J-216.png" title="J 216" width="624" height="316"></figure></li><li class="list__item" id="-83ayzb_381"><p id="-83ayzb_382">Finally, build the dungeon</p><figure id="-83ayzb_383"><img alt="J 217" src="dungeon-architect-docs/J-217.png" title="J 217" width="444" height="225"></figure></li></ul></section><section class="chapter"><h3 id="readytostartmatch" data-toc="readytostartmatch">ReadyToStartMatch</h3><p id="-83ayzb_384">We want to wait till the dungeon is fully built, before starting the game</p><p id="-83ayzb_385">Unreal Engine provides a function named <code class="code" id="-83ayzb_386">ReadyToStartMatch</code> in the <span class="emphasis" id="-83ayzb_387">GameMode</span> blueprint that lets you wait in spectator mode, until we are ready. As long as we keep returning <code class="code" id="-83ayzb_388">false</code> in this function, it will stay in spectator mode and start the game only when we return <code class="code" id="-83ayzb_389">true</code></p><p id="-83ayzb_390">We have a variable <code class="code" id="-83ayzb_391">DungeonReady</code> that is set to false by default and is set to true only after the spawn room has been fully streamed in. We will override this function and simply return the value of this variable</p><p id="-83ayzb_392">Override the <code class="code" id="-83ayzb_393">ReadyToStartMatch</code> function</p><figure id="-83ayzb_394"><img alt="J 218" src="dungeon-architect-docs/J-218.png" title="J 218" width="544" height="857"></figure><figure id="-83ayzb_395"><img alt="J 219" src="dungeon-architect-docs/J-219.png" title="J 219" width="585" height="187"></figure><p id="-83ayzb_396">This will make the game wait in spectator mode till the dungeon is built, and the spawn room is fully streamed in</p></section><section class="chapter"><h3 id="findplayerstart" data-toc="findplayerstart">FindPlayerStart</h3><p id="-83ayzb_397">After the game starts, the engine lets us choose a <code class="code" id="-83ayzb_398">PlayerStart</code> actor to spawn our player character at. We want to choose the <code class="code" id="-83ayzb_399">PlayerStart</code> character that was streamed in along with the spawn room</p><p id="-83ayzb_400">Start by overriding the <code class="code" id="-83ayzb_401">FindPlayerStart</code> function in the <span class="emphasis" id="-83ayzb_402">GameMode</span> blueprint</p><figure id="-83ayzb_403"><img alt="J 221" src="dungeon-architect-docs/J-221.png" title="J 221" width="541" height="653"></figure><p id="-83ayzb_404">Implement the function as shown below (right click the below image and click <code class="code" id="-83ayzb_405">Open Image in New Tab</code> for larger view)</p><figure id="-83ayzb_406"><img alt="J 220" src="dungeon-architect-docs/J-220.png" title="J 220" width="1779" height="516"></figure><p id="-83ayzb_407">We check if the dungeon is ready (i.e. the spawn room is fully streamed in). If so, we search for a <code class="code" id="-83ayzb_408">PlayerStart</code> actor, which we know will be there, since we've configured the spawn room to have one. Otherwise, we return the player character that we received as input to the function (this function might be called multiple times, even in spectator mode, so we need to do this for the engine to work correctly)</p><aside class="prompt" data-type="note" data-title="" id="-83ayzb_409"><p id="-83ayzb_410">To create the <code class="code" id="-83ayzb_411">&quot;Parent FindPlayerStart&quot;</code> node, right click on the <code class="code" id="-83ayzb_412">FindPlayerStart</code> function and choose <code class="code" id="-83ayzb_413">Add call to Parent function</code></p></aside><aside class="prompt" data-type="warning" data-title="" id="-83ayzb_414"><p id="-83ayzb_415">Make sure there are no other <code class="code" id="-83ayzb_416">PlayerStart</code> actors in the scene. You'll need to delete the default <code class="code" id="-83ayzb_417">PlayerStart</code> actor in the main scene file, to make sure that doesn't get picked up</p></aside></section></section><section class="chapter"><h2 id="finalize-game-map" data-toc="finalize-game-map">Finalize Game Map</h2><section class="chapter"><h3 id="delete-default-playerstart" data-toc="delete-default-playerstart">Delete default PlayerStart</h3><p id="-83ayzb_418">In the map where we set up our dungeon actor, make sure we don't have a <code class="code" id="-83ayzb_419">PlayerStart</code> actor. If there's one, delete it</p><figure id="-83ayzb_420"><img alt="J 222" src="dungeon-architect-docs/J-222.png" title="J 222" width="482" height="230"></figure><figure id="-83ayzb_421"><img alt="J 223" src="dungeon-architect-docs/J-223.png" title="J 223" width="482" height="230"></figure></section><section class="chapter"><h3 id="set-game-mode" data-toc="set-game-mode">Set Game Mode</h3><p id="-83ayzb_422">We created a <code class="code" id="-83ayzb_423">GameMode</code> blueprint, and we'd like to use it in this map. Open up <span class="emphasis" id="-83ayzb_424">World Settings</span></p><p id="-83ayzb_425">From the Level Editor's main toolbar, choose <code class="code" id="-83ayzb_426">Settings &gt; World Settings</code></p><figure id="-83ayzb_427"><img alt="J 224" src="dungeon-architect-docs/J-224.png" title="J 224" width="630" height="242"></figure><p id="-83ayzb_428">This will open up the World Settings panel. Set the Game Mode to the blueprint we just created</p><figure id="-83ayzb_429"><img alt="J 225" src="dungeon-architect-docs/J-225.png" title="J 225" width="460" height="370"></figure><p id="-83ayzb_430">Hit Play. A random dungeon will be built, and you will be moved to the spawn room</p><figure id="-83ayzb_431"><img alt="J 226" src="dungeon-architect-docs/J-226.jpg" title="J 226" width="800" height="493"></figure></section><section class="chapter"><h3 id="add-character-class" data-toc="add-character-class">Add Character class</h3><p id="-83ayzb_432">Let's add a first person character, so we can walk around and open doors. Add a First Person (or third person) content pack from the Content Browser's <code class="code" id="-83ayzb_433">Add New</code> button</p><figure id="-83ayzb_434"><img alt="J 227" src="dungeon-architect-docs/J-227.png" title="J 227" width="351" height="897"></figure><figure id="-83ayzb_435"><img alt="J 228" src="dungeon-architect-docs/J-228.jpg" title="J 228" width="910" height="534"></figure><p id="-83ayzb_436">Navigate to the content folder and find the character blueprint</p><figure id="-83ayzb_437"><img alt="J 229" src="dungeon-architect-docs/J-229.png" title="J 229" width="581" height="313"></figure><p id="-83ayzb_438">Open the GameMode blueprint we created earlier and assign this character blueprint to it</p><p id="-83ayzb_439">Open the game blueprint:</p><figure id="-83ayzb_440"><img alt="J 209" src="dungeon-architect-docs/J-209.png" title="J 209" width="113" height="147"></figure><p id="-83ayzb_441">Click <code class="code" id="-83ayzb_442">Class Defaults</code></p><figure id="-83ayzb_443"><img alt="J 230" src="dungeon-architect-docs/J-230.png" title="J 230" width="294" height="124"></figure><p id="-83ayzb_444">Set the <code class="code" id="-83ayzb_445">Default Pawn Class</code> to the FPS character blueprint</p><figure id="-83ayzb_446"><img alt="J 231" src="dungeon-architect-docs/J-231.png" title="J 231" width="547" height="319"></figure><p id="-83ayzb_447">Save and Hit Play</p><figure id="-83ayzb_448"><img alt="J 232" src="dungeon-architect-docs/J-232.jpg" title="J 232" width="800" height="495"></figure><p id="-83ayzb_449">You can now move around and walk through normal doors</p></section></section><section class="chapter"><h2 id="support-locked-doors" data-toc="support-locked-doors">Support Locked Doors</h2><p id="-83ayzb_450">We want to be able to open locked doors after we've picked up the keys. For this to happen, we need to implement a few things:</p><ul class="list _bullet" id="-83ayzb_451"><li class="list__item" id="-83ayzb_452"><p>Pickup the keys when we touch them and place it in our inventory</p></li><li class="list__item" id="-83ayzb_453"><p>When we get close to a locked door blueprint, check the keys in our inventory and find out if any one of them can open it</p></li><li class="list__item" id="-83ayzb_454"><p>A UI to show the keys in our inventory</p></li></ul><p id="-83ayzb_455">Dungeon Architect provides a few helper components to make this easy</p><section class="chapter"><h3 id="player-inventory" data-toc="player-inventory">Player Inventory</h3><p id="-83ayzb_456">Open the character blueprint (FirstPersonCharacter or ThirdPersonCharacter)</p><figure id="-83ayzb_457"><img alt="J 234" src="dungeon-architect-docs/J-234.jpg" title="J 234" width="113" height="168"></figure><p id="-83ayzb_458">Add the simple inventory component that comes along with the samples</p><figure id="-83ayzb_459"><img alt="J 235" src="dungeon-architect-docs/J-235.png" title="J 235" width="313" height="345"></figure><figure id="-83ayzb_460"><img alt="J 236" src="dungeon-architect-docs/J-236.png" title="J 236" width="250" height="275"></figure><p id="-83ayzb_461">You should now be able to walk around the dungeon, pick up keys and open locked doors</p></section><section class="chapter"><h3 id="player-controller" data-toc="player-controller">Player Controller</h3><p id="-83ayzb_462">Add a UI to show the keys in the inventory. We do this with a player controller</p><p id="-83ayzb_463">Create a new Player Controller and add this to the Begin Play</p><figure id="-83ayzb_464"><img alt="J 237" src="dungeon-architect-docs/J-237.png" title="J 237" width="892" height="271"></figure><p id="-83ayzb_465">Set the UI reference to <code class="code" id="-83ayzb_466">DungeonArchitect Content &gt; Samples &gt; DA_SnapGridFlow_FPS &gt; Blueprints &gt; UI &gt; DA_SGF_HUD.DA_SGF_HUD</code></p><p id="-83ayzb_467">Hit play and when you pick up keys, they will be added to the inventory and UI shows them on the screen</p></section><section class="chapter"><h3 id="key-locks-blueprints" data-toc="key-locks-blueprints">Key-Locks Blueprints</h3><p id="-83ayzb_468">When you spawn a Key or a Lock blueprint from the theme engine, Dungeon Architect will check if the blueprint has the <code class="code" id="-83ayzb_469">Dungeon Flow Item Metadata</code> component attached to it. If it has one, it will set a <span class="emphasis" id="-83ayzb_470">Flow Item</span> object to it.</p><p id="-83ayzb_471">You can use this object to find the other referenced <span class="emphasis" id="-83ayzb_472">Flow Item</span> objects. The key <span class="emphasis" id="-83ayzb_473">flow item</span> will reference all the valid <span class="emphasis" id="-83ayzb_474">lock flow</span> items, and you can use this to check if the keys can open up a lock</p><p id="-83ayzb_475">Navigate to the following folder and check how the sample keys and locks are implemented: <code class="code" id="-83ayzb_476">DungeonArchitect Content &gt; Samples &gt; DA_SnapGridFlow_SideScroller &gt; Snap &gt; Connection &gt; Blueprints &gt; BP_SGF_Key_Base</code></p><figure id="-83ayzb_477"><img alt="J 238" src="dungeon-architect-docs/J-238.jpg" title="J 238" width="673" height="508"></figure></section></section><div class="last-modified">Last modified: 28 May 2024</div><div data-feedback-placeholder="true"></div><div class="navigation-links _bottom"><a href="sgf-finalize-graph.html" class="navigation-links__prev">Finalize Graph</a><a href="sgf-control-node-placement.html" class="navigation-links__next">Control Node Placement</a></div></article><div id="disqus_thread"></div></div></section></main></div><script src="https://resources.jetbrains.com/writerside/apidoc/6.10.0-b259/app.js"></script>
    <script src="../js/unreal.js" defer></script>
</body></html>